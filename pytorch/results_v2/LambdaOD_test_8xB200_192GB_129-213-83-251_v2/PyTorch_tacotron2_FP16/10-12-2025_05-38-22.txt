/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:404: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=args.amp)
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:404: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=args.amp)
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:404: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=args.amp)
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:404: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=args.amp)
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:404: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=args.amp)
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:404: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=args.amp)
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:404: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=args.amp)
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:404: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=args.amp)
DLL 2025-12-10 05:38:35.196315 - PARAMETER output : ./ 
DLL 2025-12-10 05:38:35.196357 - PARAMETER dataset_path : /data/tacotron2/LJSpeech-1.1 
DLL 2025-12-10 05:38:35.196376 - PARAMETER model_name : Tacotron2 
DLL 2025-12-10 05:38:35.196387 - PARAMETER log_file : nvlog.json 
DLL 2025-12-10 05:38:35.196396 - PARAMETER anneal_steps : None 
DLL 2025-12-10 05:38:35.196405 - PARAMETER anneal_factor : 0.1 
DLL 2025-12-10 05:38:35.196413 - PARAMETER config_file : None 
DLL 2025-12-10 05:38:35.196420 - PARAMETER seed : None 
DLL 2025-12-10 05:38:35.196427 - PARAMETER epochs : 3 
DLL 2025-12-10 05:38:35.196435 - PARAMETER epochs_per_checkpoint : 50 
DLL 2025-12-10 05:38:35.196442 - PARAMETER checkpoint_path :  
DLL 2025-12-10 05:38:35.196449 - PARAMETER resume_from_last : False 
DLL 2025-12-10 05:38:35.196457 - PARAMETER dynamic_loss_scaling : True 
DLL 2025-12-10 05:38:35.196464 - PARAMETER amp : False 
DLL 2025-12-10 05:38:35.196471 - PARAMETER cudnn_enabled : True 
DLL 2025-12-10 05:38:35.196478 - PARAMETER cudnn_benchmark : False 
DLL 2025-12-10 05:38:35.196485 - PARAMETER disable_uniform_initialize_bn_weight : False 
DLL 2025-12-10 05:38:35.196491 - PARAMETER use_saved_learning_rate : False 
DLL 2025-12-10 05:38:35.196498 - PARAMETER learning_rate : 0.0 
DLL 2025-12-10 05:38:35.196505 - PARAMETER weight_decay : 1e-06 
DLL 2025-12-10 05:38:35.196513 - PARAMETER grad_clip_thresh : 1.0 
DLL 2025-12-10 05:38:35.196520 - PARAMETER batch_size : 640 
DLL 2025-12-10 05:38:35.196527 - PARAMETER grad_clip : 5.0 
DLL 2025-12-10 05:38:35.196533 - PARAMETER load_mel_from_disk : False 
DLL 2025-12-10 05:38:35.196540 - PARAMETER training_files : filelists/ljs_audio_text_train_subset_10000_filelist.txt 
DLL 2025-12-10 05:38:35.196547 - PARAMETER validation_files : filelists/ljs_audio_text_val_filelist.txt 
DLL 2025-12-10 05:38:35.196554 - PARAMETER text_cleaners : ['english_cleaners'] 
DLL 2025-12-10 05:38:35.196563 - PARAMETER max_wav_value : 32768.0 
DLL 2025-12-10 05:38:35.196570 - PARAMETER sampling_rate : 22050 
DLL 2025-12-10 05:38:35.196577 - PARAMETER filter_length : 1024 
DLL 2025-12-10 05:38:35.196584 - PARAMETER hop_length : 256 
DLL 2025-12-10 05:38:35.196591 - PARAMETER win_length : 1024 
DLL 2025-12-10 05:38:35.196597 - PARAMETER mel_fmin : 0.0 
DLL 2025-12-10 05:38:35.196604 - PARAMETER mel_fmax : 8000.0 
DLL 2025-12-10 05:38:35.196611 - PARAMETER rank : 0 
DLL 2025-12-10 05:38:35.196618 - PARAMETER world_size : 8 
DLL 2025-12-10 05:38:35.196625 - PARAMETER dist_url : tcp://localhost:23456 
DLL 2025-12-10 05:38:35.196632 - PARAMETER group_name : group_name 
DLL 2025-12-10 05:38:35.196639 - PARAMETER dist_backend : nccl 
DLL 2025-12-10 05:38:35.196646 - PARAMETER bench_class :  
DLL 2025-12-10 05:38:35.196654 - PARAMETER model_name : Tacotron2_PyT 
Initializing Distributed
Done initializing distributed
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:484: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=args.amp):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:484: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=args.amp):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:484: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=args.amp):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:484: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=args.amp):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:484: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=args.amp):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:484: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=args.amp):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:484: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=args.amp):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:484: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=args.amp):
DLL 2025-12-10 05:39:02.503835 - (0, 0) glob_iter/iters_per_epoch : 0/1 
DLL 2025-12-10 05:39:07.331128 - (0, 0) train_loss : 46.91487503051758 
DLL 2025-12-10 05:39:08.997936 - (0, 0) train_items_per_sec : 445630.2027338139 items/s
DLL 2025-12-10 05:39:08.998028 - (0, 0) train_iter_time : 6.494176072999835 
DLL 2025-12-10 05:39:09.036748 - (0,) train_items_per_sec : 445630.2027338139 items/s
DLL 2025-12-10 05:39:09.036805 - (0,) train_loss : 46.91487503051758 
DLL 2025-12-10 05:39:09.036823 - (0,) train_epoch_time : 15.772795427998062 
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:293: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=amp_run):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:293: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=amp_run):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:293: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=amp_run):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:293: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=amp_run):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:293: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=amp_run):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:293: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=amp_run):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:293: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=amp_run):
/workspace/benchmark/SpeechSynthesis/Tacotron2/train.py:293: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=amp_run):
DLL 2025-12-10 05:39:09.762962 - (0, 1, 0) val_items_per_sec : 109782.01480203269 items/s
DLL 2025-12-10 05:39:09.811212 - (0,) val_loss : 48.23138427734375 None
DLL 2025-12-10 05:39:09.811264 - (0,) val_items_per_sec : 109782.01480203269 items/s
Saving model and optimizer state at epoch 0 to ./checkpoint_Tacotron2_0.pt
Updating symlink ./checkpoint_Tacotron2_last.pt to point to checkpoint_Tacotron2_0.pt
DLL 2025-12-10 05:39:19.205719 - (1, 0) glob_iter/iters_per_epoch : 1/1 
DLL 2025-12-10 05:39:21.111174 - (1, 0) train_loss : 46.755096435546875 
DLL 2025-12-10 05:39:22.444860 - (1, 0) train_items_per_sec : 891210.9386196028 items/s
DLL 2025-12-10 05:39:22.444952 - (1, 0) train_iter_time : 3.2391837609975482 
DLL 2025-12-10 05:39:22.553026 - (1,) train_items_per_sec : 891210.9386196028 items/s
DLL 2025-12-10 05:39:22.553110 - (1,) train_loss : 46.755096435546875 
DLL 2025-12-10 05:39:22.553134 - (1,) train_epoch_time : 12.310951273997489 
DLL 2025-12-10 05:39:23.248902 - (1, 2, 0) val_items_per_sec : 119860.82693493128 items/s
DLL 2025-12-10 05:39:23.301038 - (1,) val_loss : 48.24058532714844 None
DLL 2025-12-10 05:39:23.301082 - (1,) val_items_per_sec : 119860.82693493128 items/s
DLL 2025-12-10 05:39:32.201481 - (2, 0) glob_iter/iters_per_epoch : 2/1 
DLL 2025-12-10 05:39:33.559122 - (2, 0) train_loss : 46.75722122192383 
DLL 2025-12-10 05:39:34.900443 - (2, 0) train_items_per_sec : 1067168.633893507 items/s
DLL 2025-12-10 05:39:34.900516 - (2, 0) train_iter_time : 2.699013921999722 
DLL 2025-12-10 05:39:35.011821 - (2,) train_items_per_sec : 1067168.633893507 items/s
DLL 2025-12-10 05:39:35.011890 - (2,) train_loss : 46.75722122192383 
DLL 2025-12-10 05:39:35.011907 - (2,) train_epoch_time : 11.709794511996733 
DLL 2025-12-10 05:39:35.734630 - (2, 3, 0) val_items_per_sec : 125885.66681862804 items/s
DLL 2025-12-10 05:39:35.788551 - (2,) val_loss : 48.25196838378906 None
DLL 2025-12-10 05:39:35.788596 - (2,) val_items_per_sec : 125885.66681862804 items/s
DLL 2025-12-10 05:39:35.789726 - () run_time : 50.03266746999725 s
DLL 2025-12-10 05:39:35.789753 - () val_loss : 48.25196838378906 None
DLL 2025-12-10 05:39:35.789766 - () train_loss : 46.75722122192383 
DLL 2025-12-10 05:39:35.789778 - () train_items_per_sec : 1067168.633893507 items/s
DLL 2025-12-10 05:39:35.789787 - () val_items_per_sec : 125885.66681862804 items/s
[rank0]:[W1210 05:39:36.022183741 ProcessGroupNCCL.cpp:1505] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[rank3]:[W1210 05:39:36.098984420 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=98, addr=[localhost]:44628, remote=[localhost]:23456): failed to recv, got 0 bytes
Exception raised from recvBytes at /opt/pytorch/pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x88 (0x76b9db993568 in /usr/local/lib/python3.12/dist-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x59a423e (0x76b94646323e in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x59a6470 (0x76b946465470 in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x59a6d7a (0x76b946465d7a in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x76b94645f839 in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x371 (0x76b8eb428f11 in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xecdb4 (0x76b8d07cddb4 in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #7: <unknown function> + 0x9caa4 (0x76ba01739aa4 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #8: __clone + 0x44 (0x76ba017c6a34 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank3]:[W1210 05:39:36.101739024 ProcessGroupNCCL.cpp:1688] [PG ID 0 PG GUID 0(default_pg) Rank 3] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank6]:[W1210 05:39:36.198442707 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=98, addr=[localhost]:44644, remote=[localhost]:23456): failed to recv, got 0 bytes
Exception raised from recvBytes at /opt/pytorch/pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x88 (0x72797f592568 in /usr/local/lib/python3.12/dist-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x59a423e (0x7278dd06323e in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x59a6470 (0x7278dd065470 in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x59a6d7a (0x7278dd065d7a in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7278dd05f839 in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x371 (0x727882028f11 in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xecdb4 (0x7278673cddb4 in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #7: <unknown function> + 0x9caa4 (0x7279992dcaa4 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #8: __clone + 0x44 (0x727999369a34 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank6]:[W1210 05:39:36.201048570 ProcessGroupNCCL.cpp:1688] [PG ID 0 PG GUID 0(default_pg) Rank 6] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
[rank5]:[W1210 05:39:36.203066119 TCPStore.cpp:125] [c10d] recvValue failed on SocketImpl(fd=99, addr=[localhost]:44674, remote=[localhost]:23456): failed to recv, got 0 bytes
Exception raised from recvBytes at /opt/pytorch/pytorch/torch/csrc/distributed/c10d/Utils.hpp:678 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x88 (0x7b8065f93568 in /usr/local/lib/python3.12/dist-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x59a423e (0x7b7fc346323e in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x59a6470 (0x7b7fc3465470 in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x59a6d7a (0x7b7fc3465d7a in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::check(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const&) + 0x2a9 (0x7b7fc345f839 in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::ProcessGroupNCCL::heartbeatMonitor() + 0x371 (0x7b7f68428f11 in /usr/local/lib/python3.12/dist-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xecdb4 (0x7b7f4d7cddb4 in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #7: <unknown function> + 0x9caa4 (0x7b807f477aa4 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #8: __clone + 0x44 (0x7b807f504a34 in /usr/lib/x86_64-linux-gnu/libc.so.6)

[rank5]:[W1210 05:39:36.205589408 ProcessGroupNCCL.cpp:1688] [PG ID 0 PG GUID 0(default_pg) Rank 5] Failed to check the "should dump" flag on TCPStore, (maybe TCPStore server has shut down too early), with error: failed to recv, got 0 bytes
DONE!
